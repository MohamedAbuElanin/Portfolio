<!doctype html>
<html lang="ar" dir="rtl">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>SIA - الملف الشخصي</title>
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
        />
        <link rel="stylesheet" href="../style.css" />
        <link rel="stylesheet" href="../template.css" />
        <link rel="stylesheet" href="profile.css" />
        <link rel="icon" type="image/x-icon" href="../Images/ICO/favicon.ico" />
    </head>
    <body>
        <!-- Navbar Start -->
        <header class="site-header">
            <nav class="site-nav" aria-label="Primary navigation">
                <input
                    type="checkbox"
                    id="navToggle"
                    class="nav-toggle"
                    aria-label="Toggle navigation menu"
                />

                <!-- Logo Section -->
                <a href="../index.html" class="brand" aria-label="SIA homepage">
                    <span class="brand__mark">
                        <img
                            src="../Images/Logo/SIA +Ra's Eye, yellow color.svg"
                            alt="شعار SIA الذهبي"
                        />
                    </span>
                </a>

                <!-- Center Navigation Links -->
                <ul class="nav-links" id="navLinks">
                    <li><a href="../index.html">الرئيسية</a></li>
                    <li><a href="../About/About.html">عن المنصة</a></li>
                    <li><a href="../Test/Test.html">الاختبار</a></li>
                    <li>
                        <a href="profile.html" aria-current="page"
                            >الملف الشخصي</a
                        >
                    </li>
                    <li>
                        <a href="../privacy-terms.html">الخصوصية والشروط</a>
                    </li>
                </ul>

                <!-- Right Buttons Section -->
                <div class="nav-auth" id="navAuth">
                    <!-- Injected by auth.js -->
                </div>

                <!-- Responsive Menu (Hamburger control) -->
                <label
                    for="navToggle"
                    class="hamburger"
                    aria-label="Open navigation menu"
                >
                    <span></span>
                    <span></span>
                    <span></span>
                </label>

                <!-- Responsive Menu -->
                <div class="nav-drawer" aria-hidden="true">
                    <ul class="drawer-links">
                        <li><a href="../index.html">الرئيسية</a></li>
                        <li><a href="../About/About.html">عن المنصة</a></li>
                        <li><a href="../Test/Test.html">الاختبار</a></li>
                        <li>
                            <a href="profile.html" aria-current="page"
                                >الملف الشخصي</a
                            >
                        </li>
                        <li>
                            <a href="../privacy-terms.html">الخصوصية والشروط</a>
                        </li>
                    </ul>
                    <!-- Drawer Auth Buttons -->
                    <div class="drawer-auth">
                        <!-- Injected by auth.js -->
                    </div>
                </div>
            </nav>
        </header>

        <!-- Main Content -->
        <main class="profile-main">
            <div class="container py-5">
                <!-- Loading Indicator -->
                <div
                    id="profileLoadingIndicator"
                    class="text-center py-5"
                    style="display: none"
                >
                    <div class="spinner-border text-warning" role="status">
                        <span class="visually-hidden">جاري التحميل...</span>
                    </div>
                    <p class="mt-3 text-muted">جاري تحميل ملفك الشخصي...</p>
                </div>

                <!-- Error Message -->
                <div
                    id="profileErrorMessage"
                    class="alert alert-danger"
                    style="display: none"
                    role="alert"
                ></div>

                <!-- Profile Content -->
                <div id="profileContent" style="display: none">
                    <!-- Profile Header Section -->
                    <section class="profile-header-section mb-5">
                        <div class="row justify-content-center">
                            <div class="col-md-8 text-center">
                                <!-- Profile Picture -->
                                <div class="profile-picture-wrapper mb-4">
                                    <div class="profile-picture-container">
                                        <img
                                            id="profilePicture"
                                            src="../Images/Profile Photo/SVG/Male.svg"
                                            alt="الصورة الشخصية"
                                            class="profile-picture"
                                        />
                                        <button
                                            id="uploadPhotoBtn"
                                            class="upload-photo-btn"
                                            title="تحميل صورة"
                                        >
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <input
                                            type="file"
                                            id="photoInput"
                                            accept="image/*"
                                            style="display: none"
                                        />
                                    </div>
                                </div>

                                <!-- User Name -->
                                <h1
                                    id="profileUserName"
                                    class="profile-name mb-2"
                                >
                                    جاري التحميل...
                                </h1>

                                <!-- User Email -->
                                <p
                                    id="profileUserEmail"
                                    class="text-muted mb-4"
                                >
                                    جاري التحميل...
                                </p>

                                <!-- Action Buttons -->
                                <div class="profile-actions">
                                    <button
                                        id="editProfileBtn"
                                        class="btn btn-outline-warning me-2"
                                    >
                                        <i class="fas fa-edit me-2"></i>تعديل
                                        الملف الشخصي
                                    </button>
                                    <button
                                        id="exportPDFBtn"
                                        class="btn btn-outline-light me-2"
                                    >
                                        <i class="fas fa-download me-2"></i
                                        >تصدير PDF
                                    </button>
                                    <button
                                        id="logoutBtn"
                                        class="btn btn-outline-danger"
                                    >
                                        <i class="fas fa-sign-out-alt me-2"></i
                                        >تسجيل الخروج
                                    </button>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Tests Section -->
                    <section class="tests-section mb-5">
                        <h2 class="section-title mb-4">
                            <i class="fas fa-clipboard-list me-2"></i>اختبارات
                            الشخصية
                        </h2>
                        <div class="row g-4">
                            <!-- Holland Test Card -->
                            <div class="col-md-6">
                                <div class="test-card" id="hollandTestCard">
                                    <div class="test-card-header">
                                        <img
                                            src="../Images/Test/Holland codes.svg"
                                            alt="اختبار أكواد هولاند"
                                            class="test-image"
                                        />
                                        <h3 class="test-title">
                                            اختبار أكواد هولاند
                                        </h3>
                                    </div>
                                    <div class="test-card-body">
                                        <p class="test-description">
                                            اكتشف اهتماماتك المهنية ونوع شخصيتك
                                            من خلال تقييم أكواد هولاند.
                                        </p>
                                        <div
                                            id="hollandTestStatus"
                                            class="test-status"
                                        >
                                            <!-- Status will be injected here -->
                                        </div>
                                        <div class="test-actions">
                                            <button
                                                id="startHollandBtn"
                                                class="btn btn-warning w-100"
                                                style="display: none"
                                            >
                                                <i class="fas fa-play me-2"></i
                                                >بدء الاختبار
                                            </button>
                                            <button
                                                id="viewHollandBtn"
                                                class="btn btn-success w-100"
                                                style="display: none"
                                            >
                                                <i
                                                    class="fas fa-chart-bar me-2"
                                                ></i
                                                >عرض النتائج
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Big Five Test Card -->
                            <div class="col-md-6">
                                <div class="test-card" id="bigFiveTestCard">
                                    <div class="test-card-header">
                                        <img
                                            src="../Images/Test/Big Five.svg"
                                            alt="اختبار السمات الخمس الكبرى"
                                            class="test-image"
                                        />
                                        <h3 class="test-title">
                                            اختبار السمات الخمس الكبرى
                                        </h3>
                                    </div>
                                    <div class="test-card-body">
                                        <p class="test-description">
                                            افهم سمات شخصيتك عبر خمسة أبعاد
                                            رئيسية.
                                        </p>
                                        <div
                                            id="bigFiveTestStatus"
                                            class="test-status"
                                        >
                                            <!-- Status will be injected here -->
                                        </div>
                                        <div class="test-actions">
                                            <button
                                                id="startBigFiveBtn"
                                                class="btn btn-warning w-100"
                                                style="display: none"
                                            >
                                                <i class="fas fa-play me-2"></i
                                                >بدء الاختبار
                                            </button>
                                            <button
                                                id="viewBigFiveBtn"
                                                class="btn btn-success w-100"
                                                style="display: none"
                                            >
                                                <i
                                                    class="fas fa-chart-bar me-2"
                                                ></i
                                                >عرض النتائج
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                    <!-- Final Analysis Section (Appears when both tests are done) -->
                    <section
                        id="final-analysis-section"
                        class="final-analysis-section mb-5"
                        style="display: none"
                    >
                        <h2 class="section-title mb-4">
                            <i class="fas fa-magic me-2"></i>التحليل المهني
                            الشامل
                        </h2>
                        <div class="career-card">
                            <div class="career-header">
                                <h3 id="finalCareerTitle" class="career-title">
                                    جاري التجهيز...
                                </h3>
                                <span class="career-fit-badge">توافق عالي</span>
                            </div>
                            <div
                                id="finalAnalysisText"
                                class="career-description-container"
                            >
                                <!-- Injected by profile_new.js -->
                            </div>

                            <div class="row info-grid mt-4">
                                <div class="col-md-6 mb-3">
                                    <h4 class="text-yellow mb-3">
                                        <i
                                            class="fas fa-graduation-cap me-6"
                                        ></i
                                        >دورات تدريبية
                                    </h4>
                                    <ul
                                        id="finalCoursesList"
                                        class="roadmap-steps"
                                    ></ul>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <h4 class="text-yellow mb-3">
                                        <i class="fas fa-book me-6"></i>كتب
                                        مرشحة
                                    </h4>
                                    <ul
                                        id="finalBooksList"
                                        class="roadmap-steps"
                                    ></ul>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Activity Log Section -->
                    <section class="activity-log-section mb-5">
                        <h2 class="section-title mb-4">
                            <i class="fas fa-history me-2"></i>سجل النشاط
                        </h2>
                        <div class="activity-log-container">
                            <div id="activityLogList" class="activity-log-list">
                                <!-- Activity log items will be injected here -->
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="site-footer">
            <div class="footer__brand">
                <img
                    src="../Images/Logo/R'eye only in yellow color.svg"
                    alt="أيقونة عين رع SIA"
                    class="footer__logo"
                />
                <div>
                    <p class="footer__title">SIA</p>
                    <p class="footer__mission">
                        نربط الحكمة القديمة بمسارات المهن الحديثة.
                    </p>
                </div>
            </div>
            <div class="footer__nav" aria-label="Footer navigation">
                <a href="../index.html">الرئيسية</a>
                <a href="../About/About.html">عن SIA</a>
                <a href="../Test/Test.html">الاختبار</a>
                <a href="../profile/profile.html">الملف الشخصي</a>
                <a href="../privacy-terms.html">الخصوصية والشروط</a>
            </div>
            <!-- Social Media Icons -->
            <div class="footer__social">
                <a
                    href="https://www.instagram.com/mohamedosman.mo189/"
                    target="_blank"
                    rel="noopener noreferrer"
                    aria-label="Instagram"
                    class="social-icon"
                >
                    <i class="fab fa-instagram"></i>
                </a>
                <a
                    href="https://www.facebook.com/mohamed.othman.abu.el.enein/"
                    target="_blank"
                    rel="noopener noreferrer"
                    aria-label="Facebook"
                    class="social-icon"
                >
                    <i class="fab fa-facebook"></i>
                </a>
                <a
                    href="https://www.threads.com/@mohamedosman.mo189"
                    target="_blank"
                    rel="noopener noreferrer"
                    aria-label="threads"
                    class="social-icon"
                >
                    <i class="fab fa-threads"></i>
                </a>
                <a
                    href="https://wa.me/201210146694"
                    target="_blank"
                    rel="noopener noreferrer"
                    aria-label="WhatsApp"
                    class="social-icon"
                >
                    <i class="fab fa-whatsapp"></i>
                </a>
                <a
                    href="mailto:medsmohamed910@gmail.com"
                    aria-label="Email"
                    class="social-icon"
                >
                    <i class="fas fa-envelope"></i>
                </a>
            </div>
            <div class="footer__copy">
                <p>&copy; 2026 SIA. All rights reserved.</p>
                <p class="footer__motto">
                    Ancient Wisdom for Modern Career Paths
                </p>
            </div>
        </footer>

        <!-- Edit Profile Modal -->
        <div
            class="modal fade"
            id="editProfileModal"
            tabindex="-1"
            aria-hidden="true"
        >
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content bg-dark text-light">
                    <div class="modal-header border-secondary">
                        <h5 class="modal-title">تعديل الملف الشخصي</h5>
                        <button
                            type="button"
                            class="btn-close btn-close-white"
                            data-bs-dismiss="modal"
                            aria-label="Close"
                        ></button>
                    </div>
                    <div class="modal-body">
                        <form id="editProfileForm">
                            <div class="mb-3">
                                <label for="editName" class="form-label"
                                    >الاسم الكامل</label
                                >
                                <input
                                    type="text"
                                    class="form-control bg-dark text-light border-secondary"
                                    id="editName"
                                    required
                                />
                            </div>
                            <div class="mb-3">
                                <label for="editEmail" class="form-label"
                                    >البريد الإلكتروني</label
                                >
                                <input
                                    type="email"
                                    class="form-control bg-dark text-light border-secondary"
                                    id="editEmail"
                                    disabled
                                />
                            </div>
                            <div class="mb-3">
                                <label for="editAge" class="form-label"
                                    >العمر</label
                                >
                                <input
                                    type="number"
                                    class="form-control bg-dark text-light border-secondary"
                                    id="editAge"
                                    min="1"
                                    max="120"
                                />
                            </div>
                            <div class="mb-3">
                                <label for="editGender" class="form-label"
                                    >الجنس</label
                                >
                                <select
                                    class="form-select bg-dark text-light border-secondary"
                                    id="editGender"
                                >
                                    <option value="">اختر الجنس</option>
                                    <option value="male">ذكر</option>
                                    <option value="female">أنثى</option>
                                </select>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer border-secondary">
                        <button
                            type="button"
                            class="btn btn-secondary"
                            data-bs-dismiss="modal"
                        >
                            إلغاء
                        </button>
                        <button
                            type="button"
                            class="btn btn-warning"
                            id="saveProfileBtn"
                        >
                            حفظ التغييرات
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Hidden PDF Export Template - Simplified for better PDF rendering -->
        <div
            id="pdfExportTemplate"
            style="
                display: none;
                width: 750px;
                padding: 50px;
                background: #fff;
                color: #333;
                direction: rtl;
                font-family: Arial, Tahoma, sans-serif;
                line-height: 1.5;
            "
        >
            <!-- Header -->
            <div
                style="
                    border-bottom: 3px solid #d4af37;
                    padding-bottom: 30px;
                    margin-bottom: 40px;
                    text-align: right;
                    position: relative;
                    min-height: 120px;
                "
            >
                <img
                    src="../Images/Logo/SIA +Ra's Eye, black color.svg"
                    alt="SIA Logo"
                    style="width: 120px; float: left"
                />
                <h1
                    style="
                        color: #000;
                        margin: 0;
                        font-size: 28px;
                        padding-top: 10px;
                    "
                >
                    تقرير SIA المهني الشامل
                </h1>
                <p
                    style="
                        margin: 10px 0 5px 0;
                        color: #000000;
                        font-size: 16px;
                    "
                    id="pdfUserName"
                >
                    :الاسم
                </p>
                <p
                    style="margin: 5px 0; color: #000000; font-size: 14px"
                    id="pdfDate"
                >
                    :التاريخ
                </p>
                <div style="clear: both"></div>
            </div>

            <!-- Career Analysis Section -->
            <div style="margin-bottom: 50px">
                <h2
                    style="
                        color: #d4af37;
                        border-bottom: 2px solid #ffffff;
                        padding-bottom: 12px;
                        font-size: 22px;
                    "
                >
                    1. التحليل المهني المقترح
                </h2>
                <div style="padding: 15px 0">
                    <h3
                        id="pdfCareerTitle"
                        style="
                            color: #c9a01b;
                            margin-bottom: 20px;
                            font-size: 20px;
                            font-weight: bold;
                        "
                    ></h3>
                    <div
                        id="pdfFinalAnalysis"
                        style="font-size: 15px; text-align: justify"
                    ></div>
                </div>
            </div>

            <!-- Holland Results -->
            <div style="margin-bottom: 50px; page-break-inside: avoid">
                <h2
                    style="
                        color: #d4af37;
                        border-bottom: 2px solid #ffffff;
                        padding-bottom: 12px;
                        font-size: 22px;
                    "
                >
                    2. نتائج اختبار هولاند
                </h2>
                <div
                    id="pdfHollandResults"
                    style="margin-top: 20px; overflow: hidden"
                >
                    <!-- Items will be injected as inline-blocks -->
                </div>
            </div>

            <!-- Big Five Results -->
            <div style="margin-bottom: 50px; page-break-inside: avoid">
                <h2
                    style="
                        color: #d4af37;
                        border-bottom: 2px solid #ffffff;
                        padding-bottom: 12px;
                        font-size: 22px;
                    "
                >
                    3. سمات الشخصية
                </h2>
                <div id="pdfBigFiveResults" style="margin-top: 20px">
                    <!-- Bars will be injected here -->
                </div>
            </div>


        <!-- Firebase SDK - MUST load in this exact order -->
        <!-- 1. Firebase Config (ES Module) -->
        <script type="module" src="../firebase-config.js"></script>
        <!-- 2. Auth State (ES Module - depends on firebase-config) -->
        <script type="module" src="../auth-state.js"></script>
        <!-- 3. Auth UI (ES Module - depends on firebase-config and auth-state) -->
        <script type="module" src="../auth.js"></script>
        <!-- 4. Auth Guard (Regular script - depends on auth-state) -->
        <script src="../auth-guard.js"></script>

        <!-- Config -->
        <!-- 5. Config (Regular script - no dependencies) -->
        <script src="../config.js"></script>

        <!-- Bootstrap JS -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

        <!-- html2pdf for PDF export -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

        <!-- Profile Script -->
        <script type="module" src="profile_new.js"></script>
    </body>
</html>
